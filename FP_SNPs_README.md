### Инструкция по работе со скриптом convert_alleles.py
Данный файл содержит описание скрипта convert_alleles.py, команды для предподготовки входного файла, комментариями к этим командам, описанием работы скрипта применительно к FP_SNPs.txt и его результаты.
## 1. Предподготовка входного файла
```bash
tail -n +2 FP_SNPs.txt \  #удаляет первую строку с заголовком
  | awk -F"\t" '{ if ($2 != "23") \  #отбрасывает варианты X-хромосомы (номер 23)
        printf("chr%s\t%s\trs%s\t%s\t%s\n", $2, $4, $1, $5, $6) }' \  #формирует новую строку с префиксами chr и rs
  | awk 'BEGIN{print "#CHROM\tPOS\tID\tallele1\tallele2"}1' \  #добавляет корректные заголовки
  > FP_SNPs_10k_GB38_twoAllelsFormat.tsv
```
## 2. Описание скрипта convert_alleles.py
Определяет, какая из двух аллелей (allele1, allele2) является референсной (REF), а какой — альтернативной (ALT), с учётом последовательности референсного генома.
<b>Краткий принцип работы:</b>
1. Чтение входного TSV с колонками #CHROM, POS, ID, allele1, allele2.
2. Для каждой строки:
   - Определяем путь к директории со всеми FASTA-файлами хромосом (/ref/GRCh38.d1.vd1_mainChr/sepChrs/).
   - Получаем референсный нуклеотид на позиции POS.
   - Сравниваем с allele1 и allele2:
     - Если совпадает allele1, пишем REF=allele1, ALT=allele2.
     - Если совпадает allele2, меняем местами.
   - Иначе логируем предупреждение и пропускаем.
3. Выводим файл с колонками #CHROM, POS, ID, REF, ALT.
## 3. Запуск скрипта
Команда для запуска скрипта:
```bash
python3 convert_alleles.py \
  --input FP_SNPs_10k_GB38_twoAllelsFormat.tsv \
  --output FP_SNPs_10k_GB38_REF_ALT.tsv \
  --reference /ref/GRCh38.d1.vd1_mainChr/sepChrs/
```
## 4. Результаты работы скрипта
Результат работы скрипта &mdash; файл FP_SNPs_10k_GB38_REF_ALT.tsv. Log-файл работы скрипта представлен в файле script-logs.log.
По результатам работы скрипта удалось распознать и сконвертировать все строки исходного файла, кроме 9 позиций, где ни одна аллель не совпала с референсом (примеры указаны в log-файле и ниже). Эти строки были пропущены и не включены в выходной файл.
```bash
2025-04-22 13:56:17,534 [WARNING] Ни одна аллель не совпадает с референсом: chr1:145899155. Референс=G, аллели=T/C.
2025-04-22 13:56:23,972 [WARNING] Ни одна аллель не совпадает с референсом: chr10:47420743. Референс=G, аллели=T/C.
2025-04-22 13:56:23,974 [WARNING] Ни одна аллель не совпадает с референсом: chr10:47320207. Референс=T, аллели=C/A.
2025-04-22 13:56:23,977 [WARNING] Ни одна аллель не совпадает с референсом: chr10:47268342. Референс=A, аллели=T/C.
2025-04-22 13:56:23,981 [WARNING] Ни одна аллель не совпадает с референсом: chr10:47099482. Референс=T, аллели=G/A.
2025-04-22 13:56:23,991 [WARNING] Ни одна аллель не совпадает с референсом: chr10:46031829. Референс=C, аллели=A/G.
2025-04-22 13:56:24,665 [WARNING] Ни одна аллель не совпадает с референсом: chr11:54678670. Референс=G, аллели=C/T.
2025-04-22 13:56:26,726 [WARNING] Ни одна аллель не совпадает с референсом: chr15:22907410. Референс=G, аллели=T/C.
2025-04-22 13:56:26,729 [WARNING] Ни одна аллель не совпадает с референсом: chr15:22832212. Референс=A, аллели=T/C
```
Файл FP_SNPs_10k_GB38_REF_ALT.tsv содержит 5 колонок: #CHROM – название хромосомы (chr1…chr22, chrX, chrY, chrM), POS – позиция варианта в сборке GRCh38, ID – уникальный идентификатор SNP (rsID), REF – референсная аллель, ALT – альтернативная аллель.
